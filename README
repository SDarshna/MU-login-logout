Script used to find the login and logout for all the mobile users/ given mobile user(default all users). The default time for which the script is executed is 1 hour. The number of hours can be specified with option timerange.




(base) dsubashchand@M-JY4VCQYQ64 MU Login_Logout % python3 MU_Login_Logout.py --help
usage: MU_Login_Logout.py [-h] [-t1 T1SECRET] [-option OPTION] [-timerange TIMERANGE] [-user USER]

Checking MU Status

optional arguments:
  -h, --help            show this help message and exit
  -t1 T1SECRET, --T1Secret T1SECRET
                        Input secret file in .yml format for the tenant(T1)
  -option OPTION, --Option OPTION
                        user/loc/all to query based on user or location
  -timerange TIMERANGE, --TimeRange TIMERANGE
                        Time range in hours for which data needs to be fetched
  -user USER, --User USER
                        Check login/logout times for a given Mobile user
   
  (base) dsubashchand@M-JY4VCQYQ64 MU Login_Logout % python3 MU_Login_Logout.py -time 920  
--------------------------+------------------------+----------------+---------------+---------------+---------------+
| GP-User-Name             | Client Private address | User Source IP | Country Name  | Login Time    | Logout Time   |
+==========================+========================+================+===============+===============+===============+
| tony@panwsase.com        | 172.20.102.2           | 159.196.7.172  | Australia     | 1672875225000 | 1673423365000 |
+--------------------------+------------------------+----------------+---------------+---------------+---------------+
| tony@panwsase.com        | 172.20.99.10           | 159.196.7.172  | Australia     | 1671666182000 | 1671686780000 |
+--------------------------+------------------------+----------------+---------------+---------------+---------------+
| alice1@panwsase.com      | 172.20.39.2            | 69.9.240.209   | United States | 1672940641000 | 1673474157000 |
+--------------------------+------------------------+----------------+---------------+---------------+---------------+
| tony@panwsase.com        | 172.20.99.10           | 159.196.7.172  | Australia     | 1671594889000 | 1671663748000 |
+--------------------------+------------------------+----------------+---------------+---------------+---------------+
| EricClapton@panwsase.com | 172.20.38.2            | 66.31.121.50   | United States | 1672856264000 | 1672857723000 |
+--------------------------+------------------------+----------------+---------------+---------------+---------------+
| BobGreen@panwsase.com    | 172.20.32.49           | 199.167.54.229 | United States | 1670457142000 | 1672867745000 |
+--------------------------+------------------------+----------------+---------------+---------------+---------------+
| alice6@panwsase.com      | 172.20.32.43           | 20.245.227.153 | United States | 1672855920000 | 1672856534000 |
+--------------------------+------------------------+----------------+---------------+---------------+---------------+
| AliceCooper@panwsase.com | 172.20.39.4            | 199.167.54.229 | United States | 1673378438000 | 1674107439000 |
+--------------------------+------------------------+----------------+---------------+---------------+---------------+
| tony@panwsase.com        | 172.20.99.10           | 159.196.7.172  | Australia     | 1672185764000 | 1672286565000 |
+--------------------------+------------------------+----------------+---------------+---------------+---------------+
| alice1@panwsase.com      | 172.20.39.3            | 52.176.6.165   | United States | 1672942759000 | 1672943089000 |
+--------------------------+------------------------+----------------+---------------+---------------+---------------+
| EricClapton@panwsase.com | 172.20.42.3            | 66.31.121.50   | United States | 1673735708000 | 1673736069000 |
+--------------------------+------------------------+----------------+---------------+---------------+---------------+
| tony@panwsase.com        | 172.20.37.43           | 159.196.7.172  | Australia     | 1671573655000 | 1671577211000 |
+--------------------------+------------------------+----------------+---------------+---------------+---------------+
| tony@panwsase.com        | 172.20.99.8            | 159.196.7.172  | Australia     | 1671577129000 | 1671595221000 |
+--------------------------+------------------------+----------------+---------------+---------------+---------------+
| tony@panwsase.com        | 172.20.99.5            | 159.196.7.172  | Australia     | 1671342091000 | 1672867924000 |
+--------------------------+------------------------+----------------+---------------+---------------+---------------+
| EricClapton@panwsase.com | 172.20.37.42           | 66.31.121.50   | United States | 1671564427000 | 1672450901000 |
+--------------------------+------------------------+----------------+---------------+---------------+---------------+
| alice1@panwsase.com      | 172.20.32.59           | 69.181.64.191  | United States | 1671779488000 | 1671779885000 |
+--------------------------+------------------------+----------------+---------------+---------------+---------------+
| tony@panwsase.com        | 172.20.99.10           | 159.196.7.172  | Australia     | 1671692075000 | 1672185582000 |
+--------------------------+------------------------+----------------+---------------+---------------+---------------+
| JaneGoodall@panwsase.com | 172.20.32.48           | 199.167.54.229 | United States | 1669878413000 | 1672867745000 |
+--------------------------+------------------------+----------------+---------------+---------------+---------------+
| tony@panwsase.com        | 172.20.99.8            | 159.196.7.172  | Australia     | 1671494531000 | 1671522453000 |
+--------------------------+------------------------+----------------+---------------+---------------+---------------+
| tony@panwsase.com        | 172.20.99.10           | 159.196.7.172  | Australia     | 1672289020000 | 1672867924000 |
+--------------------------+------------------------+----------------+---------------+---------------+---------------+
| EricClapton@panwsase.com | 172.20.38.2            | 66.31.121.50   | United States | 1672858737000 | 1672859237000 |
+--------------------------+------------------------+----------------+---------------+---------------+---------------+
| alice1@panwsase.com      | 172.20.99.11           | 159.196.7.172  | Australia     | 1671611824000 | 1671663748000 |
+--------------------------+------------------------+----------------+---------------+---------------+---------------+
| tony@panwsase.com        | 172.20.37.44           | 4.154.232.103  | United States | 1671579205000 | 1671579629000 |
+--------------------------+------------------------+----------------+---------------+---------------+---------------+
| tony@panwsase.com        | 172.20.99.8            | 159.196.7.172  | Australia     | 1671522468000 | 1671573686000 |
+--------------------------+------------------------+----------------+---------------+---------------+---------------+
| tony@panwsase.com        | 172.20.32.58           | 4.154.232.103  | United States | 1671579671000 | 1671579988000 |
+--------------------------+------------------------+----------------+---------------+---------------+---------------+
| BobGreen@panwsase.com    | 172.20.37.40           | 199.167.54.229 | United States | 1669878560000 | 1672470916000 |
+--------------------------+------------------------+----------------+---------------+---------------+---------------+
| alice5@panwsase.com      | 172.20.32.45           | 199.167.54.229 | United States | 1669151620000 | 1671732029000 |
+--------------------------+------------------------+----------------+---------------+---------------+---------------+
| alice1@panwsase.com      | 172.20.99.9            | 159.196.7.172  | Australia     | 1671530001000 | 1671530633000 |
+--------------------------+------------------------+----------------+---------------+---------------+---------------+
| tony@panwsase.com        | 172.20.99.8            | 159.196.7.172  | Australia     | 1671408094000 | 1671416936000 |
+--------------------------+------------------------+----------------+---------------+---------------+---------------+
| AliceCooper@panwsase.com | 172.20.32.57           | 199.167.54.229 | United States | 1670533157000 | 1671424622000 |
+--------------------------+------------------------+----------------+---------------+---------------+---------------+
| tony@panwsase.com        | 172.20.99.8            | 159.196.7.172  | Australia     | 1671491697000 | 1671494258000 |
+--------------------------+------------------------+----------------+---------------+---------------+---------------+
| tony@panwsase.com        | 172.20.102.2           | 159.196.7.172  | Australia     | 1674087681000 | 1674521510000 |

(base) dsubashchand@M-JY4VCQYQ64 MU Login_Logout % MU_Login_Logout.py -time 920 -user "tony@panwsase.com"
+-------------------+------------------------+----------------+---------------+---------------+---------------+
| GP-User-Name      | Client Private address | User Source IP | Country Name  | Login Time    | Logout Time   |
+===================+========================+================+===============+===============+===============+
| tony@panwsase.com | 172.20.102.2           | 159.196.7.172  | Australia     | 1672875225000 | 1673423365000 |
+-------------------+------------------------+----------------+---------------+---------------+---------------+
| tony@panwsase.com | 172.20.99.10           | 159.196.7.172  | Australia     | 1671594889000 | 1671663748000 |
+-------------------+------------------------+----------------+---------------+---------------+---------------+
| tony@panwsase.com | 172.20.99.10           | 159.196.7.172  | Australia     | 1671666182000 | 1671686780000 |
+-------------------+------------------------+----------------+---------------+---------------+---------------+
| tony@panwsase.com | 172.20.37.43           | 159.196.7.172  | Australia     | 1671573655000 | 1671577211000 |
+-------------------+------------------------+----------------+---------------+---------------+---------------+
| tony@panwsase.com | 172.20.99.5            | 159.196.7.172  | Australia     | 1671342091000 | 1672867924000 |
+-------------------+------------------------+----------------+---------------+---------------+---------------+
| tony@panwsase.com | 172.20.99.10           | 159.196.7.172  | Australia     | 1672185764000 | 1672286565000 |
+-------------------+------------------------+----------------+---------------+---------------+---------------+
| tony@panwsase.com | 172.20.102.2           | 159.196.7.172  | Australia     | 1674087681000 | 1674521510000 |
+-------------------+------------------------+----------------+---------------+---------------+---------------+
| tony@panwsase.com | 172.20.99.8            | 159.196.7.172  | Australia     | 1671577129000 | 1671595221000 |
+-------------------+------------------------+----------------+---------------+---------------+---------------+
| tony@panwsase.com | 172.20.99.8            | 159.196.7.172  | Australia     | 1671494531000 | 1671522453000 |
+-------------------+------------------------+----------------+---------------+---------------+---------------+
| tony@panwsase.com | 172.20.37.44           | 4.154.232.103  | United States | 1671579205000 | 1671579629000 |
+-------------------+------------------------+----------------+---------------+---------------+---------------+
| tony@panwsase.com | 172.20.99.8            | 159.196.7.172  | Australia     | 1671522468000 | 1671573686000 |
+-------------------+------------------------+----------------+---------------+---------------+---------------+
| tony@panwsase.com | 172.20.99.10           | 159.196.7.172  | Australia     | 1672289020000 | 1672867924000 |
+-------------------+------------------------+----------------+---------------+---------------+---------------+
| tony@panwsase.com | 172.20.32.58           | 4.154.232.103  | United States | 1671579671000 | 1671579988000 |
+-------------------+------------------------+----------------+---------------+---------------+---------------+
| tony@panwsase.com | 172.20.99.8            | 159.196.7.172  | Australia     | 1671408094000 | 1671416936000 |
+-------------------+------------------------+----------------+---------------+---------------+---------------+
| tony@panwsase.com | 172.20.99.8            | 159.196.7.172  | Australia     | 1671491697000 | 1671494258000 |
+-------------------+------------------------+----------------+---------------+---------------+---------------+
| tony@panwsase.com | 172.20.99.10           | 159.196.7.172  | Australia     | 1671692075000 | 1672185582000 |
+-------------------+------------------------+----------------+---------------+---------------+---------------+
